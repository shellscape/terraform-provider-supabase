# supabase_storage_bucket (Resource)

Manages a Supabase storage bucket. Storage buckets are containers for files in Supabase Storage, providing organized file storage with configurable access policies and file restrictions.

Refer to the [Supabase Storage documentation](https://supabase.com/docs/guides/storage) for more information.

## Example Usage

### Basic Storage Bucket

```terraform
resource "supabase_storage_bucket" "images" {
  project_ref = supabase_project.example.id
  name        = "user-images"
  public      = false
}
```

### Public Bucket with File Restrictions

```terraform
resource "supabase_storage_bucket" "public_assets" {
  project_ref        = supabase_project.example.id
  name               = "public-assets"
  public             = true
  file_size_limit    = 52428800  # 50MB
  allowed_mime_types = ["image/*", "video/mp4", "application/pdf"]
}
```

### Private Bucket for Document Storage

```terraform
resource "supabase_storage_bucket" "documents" {
  project_ref        = supabase_project.example.id
  name               = "user-documents"
  public             = false
  file_size_limit    = 104857600  # 100MB
  allowed_mime_types = [
    "application/pdf",
    "application/msword",
    "application/vnd.openxmlformats-officedocument.wordprocessingml.document",
    "text/plain"
  ]
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `name` (String) Bucket name (must be unique within project)
- `project_ref` (String) Project reference ID
- `public` (Boolean) Whether the bucket is publicly accessible

### Optional

- `allowed_mime_types` (List of String) Allowed MIME types (null for no restriction). Use wildcards like 'image/*'
- `file_size_limit` (Number) Maximum file size in bytes (null for no limit)

### Read-Only

- `created_at` (String) When the bucket was created
- `id` (String) Bucket ID
- `owner` (String) Bucket owner ID
- `updated_at` (String) When the bucket was last updated

## Import

Storage buckets can be imported using the project reference and bucket name:

```shell
terraform import supabase_storage_bucket.example <project_ref>/<bucket_name>
```

For example:

```shell
terraform import supabase_storage_bucket.images abcdefghijklmnopqrst/user-images
```

## Notes

### Public vs Private Buckets

- **Public buckets** allow file downloads without authentication, but still require authentication for uploads, updates, and deletes
- **Private buckets** require authentication for all operations
- Public buckets are useful for assets like images, stylesheets, or documents that need to be publicly accessible

### File Size Limits

- The `file_size_limit` is specified in bytes
- Common values:
  - 1MB = 1,048,576 bytes
  - 10MB = 10,485,760 bytes  
  - 50MB = 52,428,800 bytes
  - 100MB = 104,857,600 bytes
- If not specified, the global project file size limit applies

### MIME Type Restrictions

- Use specific MIME types like `image/png` or `application/pdf`
- Use wildcards like `image/*` to allow all image types
- Use `video/*` to allow all video types  
- If not specified, all MIME types are allowed

### Storage API vs Management API

This resource communicates directly with the Supabase Storage API (`https://<project-ref>.supabase.co/storage/v1`) rather than the Management API. This allows full CRUD operations on storage buckets.

### Bucket Policies and RLS

- Bucket-level access control is managed through this resource (public/private setting)
- Fine-grained access control using Row Level Security (RLS) policies must be configured separately through database policies
- Refer to the [Supabase Storage Security documentation](https://supabase.com/docs/guides/storage/security/access-control) for policy examples

### Best Practices

1. **Use descriptive names**: Bucket names should clearly indicate their purpose (e.g., "user-avatars", "product-images")
2. **Set appropriate file size limits**: Prevent abuse by setting reasonable file size limits
3. **Restrict MIME types**: Only allow file types that your application expects
4. **Consider public vs private**: Only make buckets public if the files truly need to be publicly accessible
5. **Plan for organization**: Group related files into the same bucket for easier management